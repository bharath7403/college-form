<!DOCTYPE html>
<html>
<head>
  <title>College Registration</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial; padding: 20px; background: #f3f3f3; }
    .form-container {
      background: white;
      padding: 30px;
      border-radius: 10px;
      max-width: 100%;
      width: 400px;
      margin: auto;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input, button {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    button {
      background-color: blue;
      color: white;
      font-weight: bold;
    }
    table {
      width: 100%;
      margin-top: 30px;
      border-collapse: collapse;
      background: white;
      overflow-x: auto;
      display: block;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: left;
      white-space: nowrap;
    }
    th {
      background-color: #f0f0f0;
    }
    @media screen and (max-width: 600px) {
      .form-container {
        width: 95%;
      }
    }
  </style>
</head>
<body>

  <div class="form-container">
    <h2>Register College Details</h2>
    <input type="text" id="name" placeholder="Full Name">
    <input type="text" id="college" placeholder="College Name">
    <input type="text" id="roll" placeholder="Roll Number">
    <input type="text" id="department" placeholder="Department">
    <input type="email" id="email" placeholder="Email ID">
    <input type="tel" id="phone" placeholder="Phone Number">
    <button id="submitBtn" type="button">Submit</button>
  </div>

  <div style="width: 90%; margin: 30px auto;">
    <h3>Submitted Records</h3>
    <table id="dataTable">
      <thead>
        <tr>
          <th>Name</th>
          <th>College</th>
          <th>Roll</th>
          <th>Dept</th>
          <th>Email</th>
          <th>Phone</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbxe1P9v8G8BSB31wasoQ-Fhgo0XdYQrOdeaDO9x8ScEDU_saPMIyk5D4tzP8DXSiU3sxA/exec"; // Replace with your script URL

    function submitForm() {
      const name = document.getElementById("name").value.trim();
      const college = document.getElementById("college").value.trim();
      const roll = document.getElementById("roll").value.trim();
      const department = document.getElementById("department").value.trim();
      const email = document.getElementById("email").value.trim();
      const phone = document.getElementById("phone").value.trim();

      const formData = new FormData();
      formData.append("type", "register");
      formData.append("name", name);
      formData.append("college", college);
      formData.append("roll", roll);
      formData.append("department", department);
      formData.append("email", email);
      formData.append("phone", phone);

      fetch(scriptURL, { method: "POST", body: formData })
        .then(res => res.text())
        .then(result => {
          if (result === "Registered") {
            // Clear inputs
            document.getElementById("name").value = "";
            document.getElementById("college").value = "";
            document.getElementById("roll").value = "";
            document.getElementById("department").value = "";
            document.getElementById("email").value = "";
            document.getElementById("phone").value = "";
            fetchSheetData(); // Refresh the table
          } else {
            alert("Error saving data");
          }
        })
        .catch(err => alert("Error: " + err));
    }

    function fetchSheetData() {
      fetch(scriptURL, {
        method: "POST",
        body: new URLSearchParams({ type: "read" })
      })
      .then(res => res.json())
      .then(data => {
        const tableBody = document.getElementById("dataTable").getElementsByTagName("tbody")[0];
        tableBody.innerHTML = ""; // Clear old data

        // Skip the header row in sheet
        data.slice(1).forEach(row => {
          const newRow = tableBody.insertRow();
          newRow.innerHTML = row.map(cell => `<td>${cell}</td>`).join('');
        });
      })
      .catch(err => console.error("Error fetching data:", err));
    }

    document.getElementById("submitBtn").addEventListener("click", function(e) {
      e.preventDefault();
      submitForm();
    });

    // Load data when page opens
    window.addEventListener("DOMContentLoaded", fetchSheetData);
  </script>

</body>
</html>
